<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>データの活用 - 学習教材</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>データの活用 - 学習教材</h1>
        <p class="description">自分で選んだデータを使って、代表値や度数分布表について学びましょう。</p>

        <!-- モード選択 -->
        <section id="modeSelection" class="step-section">
            <h2>学習モードを選択してください</h2>

            <div class="mode-buttons">
                <button onclick="selectMode('single')" class="btn-primary mode-btn">
                    通常モード
                    <small style="display: block; margin-top: 10px; font-size: 0.9em;">1つのデータで学習する</small>
                </button>

                <button onclick="selectMode('compare')" class="btn-primary mode-btn">
                    データ比較モード
                    <small style="display: block; margin-top: 10px; font-size: 0.9em;">2つのデータを比較する</small>
                </button>
            </div>
        </section>

        <!-- ステップ1: データ入力 -->
        <section id="step1" class="step-section" style="display:none;">
            <h2>ステップ1: データを入力しよう</h2>

            <div class="input-group">
                <label for="dataTitle">1. データのタイトルを入力してください</label>
                <input type="text" id="dataTitle" placeholder="例：2025年11月の水戸市の最高気温">
            </div>

            <div class="input-group">
                <label for="dataInput">2. データを入力してください（カンマ区切り）</label>
                <input type="text" id="dataInput" placeholder="例：1,3,3,5,6,7,11,19,21">
                <small>数値をカンマ(,)で区切って入力してください</small>
            </div>

            <button onclick="loadData()" class="btn-primary">データを読み込む</button>
            <div id="dataLoadMessage" class="message"></div>
        </section>

        <!-- ステップ1（比較モード）: 2つのデータ入力 -->
        <section id="step1_compare" class="step-section" style="display:none;">
            <h2>ステップ1: 2つのデータを入力しよう</h2>

            <h3 style="color: #667eea;">データセット1</h3>
            <div class="input-group">
                <label for="dataTitle1">1. データ1のタイトルを入力してください</label>
                <input type="text" id="dataTitle1" placeholder="例：2024年11月の水戸市の最高気温">
            </div>

            <div class="input-group">
                <label for="dataInput1">2. データ1を入力してください（カンマ区切り）</label>
                <input type="text" id="dataInput1" placeholder="例：1,3,3,5,6,7,11,19,21">
                <small>数値をカンマ(,)で区切って入力してください</small>
            </div>

            <h3 style="color: #43a047; margin-top: 30px;">データセット2</h3>
            <div class="input-group">
                <label for="dataTitle2">3. データ2のタイトルを入力してください</label>
                <input type="text" id="dataTitle2" placeholder="例：2025年11月の水戸市の最高気温">
            </div>

            <div class="input-group">
                <label for="dataInput2">4. データ2を入力してください（カンマ区切り）</label>
                <input type="text" id="dataInput2" placeholder="例：2,4,5,6,8,9,12,20,22">
                <small>数値をカンマ(,)で区切って入力してください</small>
            </div>

            <button onclick="loadCompareData()" class="btn-primary">データを読み込む</button>
            <div id="dataLoadMessageCompare" class="message"></div>
        </section>

        <!-- ステップ2: 代表値を求める -->
        <section id="step2" class="step-section" style="display:none;">
            <h2>ステップ2: 代表値を求めよう</h2>
            <p>データのタイトル: <span id="displayTitle" class="data-display"></span></p>
            <p>入力されたデータ: <span id="displayData" class="data-display"></span></p>
            <p>データの個数: <span id="displayCount" class="data-display"></span>個</p>
            <p>昇順に並び替え: <span id="displaySorted" class="data-display"></span></p>
            <p>平均値: <span id="displayMean" class="data-display"></span></p>

            <div class="question-group">
                <h3>問題：次の値を求めなさい</h3>

                <div class="input-group">
                    <label>最小値:</label>
                    <input type="number" id="answerMin" step="any">
                </div>

                <div class="input-group">
                    <label>最大値:</label>
                    <input type="number" id="answerMax" step="any">
                </div>

                <div class="input-group">
                    <label>範囲（レンジ）:</label>
                    <input type="number" id="answerRange" step="any">
                </div>

                <div class="input-group">
                    <label>中央値:</label>
                    <input type="number" id="answerMedian" step="any">
                </div>

                <button onclick="checkRepresentativeValues()" class="btn-primary">答え合わせ</button>
                <div id="step2Result" class="result-message"></div>
            </div>
        </section>

        <!-- ステップ2（比較モード）: 代表値の表示 -->
        <section id="step2_compare" class="step-section" style="display:none;">
            <h2>ステップ2: 代表値を確認しよう</h2>

            <h3 style="color: #667eea;">データセット1: <span id="displayTitle1"></span></h3>
            <p>入力されたデータ: <span id="displayData1" class="data-display"></span></p>
            <p>データの個数: <span id="displayCount1" class="data-display"></span>個</p>
            <p>昇順に並び替え: <span id="displaySorted1" class="data-display"></span></p>
            <p>平均値: <span id="displayMean1" class="data-display"></span></p>
            <p>中央値: <span id="displayMedian1" class="data-display"></span></p>
            <p>最小値: <span id="displayMin1" class="data-display"></span></p>
            <p>最大値: <span id="displayMax1" class="data-display"></span></p>
            <p>範囲: <span id="displayRange1" class="data-display"></span></p>

            <h3 style="color: #43a047; margin-top: 30px;">データセット2: <span id="displayTitle2"></span></h3>
            <p>入力されたデータ: <span id="displayData2" class="data-display"></span></p>
            <p>データの個数: <span id="displayCount2" class="data-display"></span>個</p>
            <p>昇順に並び替え: <span id="displaySorted2" class="data-display"></span></p>
            <p>平均値: <span id="displayMean2" class="data-display"></span></p>
            <p>中央値: <span id="displayMedian2" class="data-display"></span></p>
            <p>最小値: <span id="displayMin2" class="data-display"></span></p>
            <p>最大値: <span id="displayMax2" class="data-display"></span></p>
            <p>範囲: <span id="displayRange2" class="data-display"></span></p>

            <button onclick="proceedToClassSettings()" class="btn-primary">次のステップへ</button>
        </section>

        <!-- ステップ2.5: 階級を設定する -->
        <section id="step2_5" class="step-section" style="display:none;">
            <h2>階級の設定</h2>
            <p>度数分布表を作成するために、階級の設定を確認してください。</p>

            <div class="question-group">
                <h3>自動設定された階級</h3>
                <p>最小値: <span id="autoMinValue" class="data-display"></span></p>
                <p>最大値: <span id="autoMaxValue" class="data-display"></span></p>
                <p>範囲: <span id="autoRange" class="data-display"></span></p>
                <p>階級の数: <span id="autoNumClasses" class="data-display"></span></p>
                <p>階級の幅: <span id="autoClassWidth" class="data-display"></span></p>

                <button onclick="useAutoSettings()" class="btn-primary">この設定で進む</button>

                <h3 style="margin-top: 30px;">手動で設定する</h3>
                <p>階級を自分で設定したい場合は、下の項目を入力してください。</p>

                <div class="input-group">
                    <label>最初の階級の下限:</label>
                    <input type="number" id="manualFirstMin" step="any" placeholder="例: 10">
                    <small>データの最小値以下の値を設定してください</small>
                </div>

                <div class="input-group">
                    <label>階級の幅:</label>
                    <input type="number" id="manualClassWidth" step="any" placeholder="例: 5">
                    <small>整数を入力してください</small>
                </div>

                <div class="input-group">
                    <label>階級の数:</label>
                    <input type="number" id="manualNumClasses" min="3" max="15" placeholder="例: 6">
                    <small>3〜15の間で設定してください</small>
                </div>

                <button onclick="useManualSettings()" class="btn-primary">手動設定で進む</button>
                <div id="step2_5Result" class="result-message"></div>
            </div>
        </section>

        <!-- ステップ3: 度数分布表を完成させる -->
        <section id="step3" class="step-section" style="display:none;">
            <h2>ステップ3: 度数分布表を完成させよう</h2>

            <div id="frequencyTableContainer"></div>

            <button onclick="checkFrequencyTable()" class="btn-primary">答え合わせ</button>
            <div id="step3Result" class="result-message"></div>
        </section>

        <!-- ステップ3（比較モード）: 度数分布表を確認する -->
        <section id="step3_compare" class="step-section" style="display:none;">
            <h2>ステップ3: 度数分布表を確認しよう</h2>
            <p>2つのデータセットを同じ階級で比較した度数分布表です。</p>

            <div id="frequencyTableContainerCompare"></div>

            <button onclick="showStep4Compare()" class="btn-primary">次のステップへ</button>
        </section>

        <!-- ステップ4: 最頻値を読み取る -->
        <section id="step4" class="step-section" style="display:none;">
            <h2>ステップ4: 度数分布表から最頻値を読み取ろう</h2>

            <div class="input-group">
                <label>最頻値（階級値）:</label>
                <input type="number" id="answerMode" step="any">
                <small>最も度数が多い階級の階級値を答えてください</small>
            </div>

            <button onclick="checkMode()" class="btn-primary">答え合わせ</button>
            <div id="step4Result" class="result-message"></div>
        </section>

        <!-- ステップ5: ヒストグラムをかく -->
        <section id="step5" class="step-section" style="display:none;">
            <h2>ステップ5: ヒストグラムをかこう</h2>

            <p>下の軸を使って、ノートにヒストグラムをかきなさい。</p>
            <p>かき終わったら、「ヒストグラムを表示」ボタンを押して答え合わせをしましょう。</p>

            <div id="histogramContainer">
                <canvas id="histogramCanvas" width="600" height="400"></canvas>
            </div>

            <button onclick="showHistogram()" class="btn-primary">ヒストグラムを表示</button>
            <div id="step5Message" class="message"></div>
        </section>

        <!-- ステップ4（比較モード）: 度数分布多角形 -->
        <section id="step4_compare" class="step-section" style="display:none;">
            <h2>ステップ4: 度数分布多角形で比較しよう</h2>

            <p>2つのデータの度数分布多角形を重ねて表示します。</p>
            <p>「度数分布多角形を表示」ボタンを押してください。</p>

            <div id="polygonContainer">
                <canvas id="polygonCanvas" width="700" height="500"></canvas>
            </div>

            <button onclick="showPolygon()" class="btn-primary">度数分布多角形を表示</button>
            <div id="step4CompareMessage" class="message"></div>
        </section>

        <!-- 結果の画像出力 -->
        <section id="exportSection" class="step-section" style="display:none;">
            <h2>結果を画像で保存</h2>
            <p>学習の結果を画像として保存できます。</p>

            <button onclick="exportAsImage()" class="btn-primary">結果を画像として保存</button>
            <div id="exportMessage" class="message"></div>

            <!-- 画像出力用の非表示キャンバス -->
            <canvas id="exportCanvas" style="display:none;"></canvas>
        </section>

        <!-- リセットボタン -->
        <div class="reset-container">
            <button onclick="resetAll()" class="btn-secondary">最初からやり直す</button>
        </div>

        <!-- フッター -->
        <div class="footer">
            <p>データの活用 学習教材 v1.0</p>
            <p>D.Y with Claude</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
